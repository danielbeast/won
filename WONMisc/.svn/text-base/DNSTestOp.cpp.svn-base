

#include "DNSTestOp.h"
#include "WONCommon/StringUtil.h"

using namespace WONAPI;


///////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////
DNSTestOp::DNSTestOp(const std::string &theHost)
{
	mHostString = theHost;
}


///////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////
DNSTestOp::~DNSTestOp()
{
}


///////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////
void DNSTestOp::RunHook()
{
	DNSTestThread* aThread = new DNSTestThread(this);
	aThread->SetAutoDelete(true);
	aThread->Start();

	AsyncOp::RunHook();
}

///////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////
void DNSTestThread::ThreadFunc()
{
	mOp->mHostAddr.SetWithDefaultPort(mOp->GetHostString(), 0);
		
	if (mOp->mHostAddr.IsValid())
		mOp->Finish(WS_Success);
	else
		mOp->Finish(WS_InvalidAddress);
}
